{% extends 'stocks/base.html' %}
{% load django_bootstrap5 %}

{% block title %}Glossary - Stock Picker{% endblock %}

{% block content %}
<div class="container-fluid">
    <h1 class="mb-4">ðŸ“– Glossary</h1>
    <p class="lead text-muted mb-4">
        Key terms and definitions to help you use this app effectively. The analysis is based on the Minervini methodology for identifying high-probability stock setups.
    </p>

    <div class="row">
        <div class="col-lg-10">
            <div class="accordion" id="glossaryAccordion">
                <!-- Signals & Action -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#signals">
                            Signals & Action
                        </button>
                    </h2>
                    <div id="signals" class="accordion-collapse collapse show" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>BUY</dt>
                                <dd>A stock meets the criteria for an actionable setup. The pattern is formed and entry conditions are present. Consider buying within the entry range.</dd>

                                <dt>WAIT</dt>
                                <dd>The stock is forming a setup but is not yet ready. Price may be in a base, awaiting a breakout, or needs more time to consolidate. Monitor for a future BUY signal.</dd>

                                <dt>PASS</dt>
                                <dd>The stock does not meet the criteria. It may be in a declining stage, failed a breakout, or lacks the required technical/fundamental factors. Avoid for now.</dd>

                                <dt>Entry Range</dt>
                                <dd>The suggested price zone (low to high) at which to consider buying. Ideally, buy near the low end of the range for better risk/reward.</dd>

                                <dt>Stop Loss</dt>
                                <dd>The price level at which to exit the position to limit losses if the trade goes against you. Typically based on the lowest point of the recent base or pivot.</dd>

                                <dt>Target (Primary)</dt>
                                <dd>The primary price target for taking profits. Based on the measured move or resistance from the base pattern.</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <!-- Holder Signals (for existing stockholders) -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#holderSignals">
                            Holder Signals (HOLD / SELL)
                        </button>
                    </h2>
                    <div id="holderSignals" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <p><strong>Parallel signal system for existing stockholders.</strong> While BUY/WAIT/PASS signals guide prospective buyers, HOLD/SELL signals help current holders decide whether to maintain or exit positions.</p>
                            
                            <dl>
                                <dt>HOLD</dt>
                                <dd>The stock's uptrend remains intact. Continue holding the position. Use the provided stop-loss levels to protect your capital. Three tiers:
                                    <ul>
                                        <li><strong>Strong Hold:</strong> Stage 2, 8+ criteria passing, RS 70+. Excellent conditions.</li>
                                        <li><strong>Moderate Hold:</strong> Stage 2, 5+ criteria passing. Uptrend intact but some slippage.</li>
                                        <li><strong>Caution Hold:</strong> Stage 1 or 3. Watch closely and tighten stops.</li>
                                    </ul>
                                </dd>

                                <dt>SELL</dt>
                                <dd>The stock's trend has deteriorated. Consider exiting the position. SELL triggers include:
                                    <ul>
                                        <li><strong>Stage 4:</strong> Confirmed downtrend.</li>
                                        <li><strong>Distribution:</strong> Price below 50-day MA in Stage 3 or 4.</li>
                                        <li><strong>Climax Top:</strong> Price 70%+ above 200-day MA (extreme overextension).</li>
                                        <li><strong>Trend Breakdown:</strong> Price below declining 200-day MA.</li>
                                        <li><strong>Severe Weakness:</strong> Relative Strength below 30.</li>
                                    </ul>
                                </dd>

                                <dt>Initial Stop (new positions)</dt>
                                <dd>A tight stop loss for recently-acquired positions, calculated relative to current price. Uses the same multi-method approach as the buyer's stop loss (ATR, EMA, VCP low, swing low), clamped between 3-8%. This is your hard floor for new entries.</dd>

                                <dt>Trailing Stop (existing positions)</dt>
                                <dd>A more forgiving stop for longer-held positions, based on rising moving averages. The system selects the highest MA below the current price (10-EMA, 21-EMA, 50-MA, or 200-MA) with a small buffer (1-2%). This gives winners room to run while protecting accumulated gains. The label (e.g., "10-EMA") shows which MA is used.</dd>

                                <dt>Holder Signal Transition</dt>
                                <dd>When a stock transitions from HOLD to SELL, a notification is generated for watchlist holders. This alerts you to deteriorating conditions before a full breakdown.</dd>
                            </dl>
                            
                            <p class="text-muted mt-3"><em>Based on Mark Minervini's selling rules: protect capital, cut losses quickly, let winners run, and recognize distribution and climax tops.</em></p>
                        </div>
                    </div>
                </div>

                <!-- Stage Analysis -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#stages">
                            Stage Analysis
                        </button>
                    </h2>
                    <div id="stages" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>Stage 1 â€“ Basing</dt>
                                <dd>Price is consolidating after a prior decline. The stock is building a base. Not yet actionable; wait for a breakout into Stage 2.</dd>

                                <dt>Stage 2 â€“ Advancing</dt>
                                <dd>The ideal stage. Price is in an uptrend, making higher highs and higher lows. This is when you want to buy breakouts from proper bases.</dd>

                                <dt>Stage 3 â€“ Topping</dt>
                                <dd>Price has extended and may be forming a top. Distribution often occurs. Be cautious; consider taking profits or tightening stops.</dd>

                                <dt>Stage 4 â€“ Declining</dt>
                                <dd>Price is in a downtrend. Avoid new purchases. Existing positions should be exited or heavily reduced.</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <!-- VCP (Volatility Contraction Pattern) -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#vcp">
                            VCP (Volatility Contraction Pattern)
                        </button>
                    </h2>
                    <div id="vcp" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>VCP â€“ Volatility Contraction Pattern</dt>
                                <dd>A consolidation pattern where each pullback within the base is smaller than the previous one. Tighter pullbacks indicate diminishing selling pressure and often precede strong breakouts.</dd>

                                <dt>VCP Score</dt>
                                <dd>A 0â€“100 score rating the quality of the VCP. Higher scores indicate cleaner, more constructive bases with proper volatility contraction.</dd>

                                <dt>Contraction Count</dt>
                                <dd>How many pullbacks (contractions) have occurred within the base. Typical VCPs have 2â€“3 contractions before the breakout.</dd>

                                <dt>Latest Contraction %</dt>
                                <dd>The depth of the most recent pullback within the base. Smaller contractions (e.g., 3â€“5%) are generally more bullish than deep ones.</dd>

                                <dt>Volume Contraction</dt>
                                <dd>Volume drying up on pullbacks within the base. Low volume on down days suggests weak selling pressure, a positive sign.</dd>

                                <dt>Pivot Price</dt>
                                <dd>The price level that, when surpassed on above-average volume, confirms the breakout and signals a potential buy point.</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <!-- Primary Base (IPO/New Issues) -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#primaryBase">
                            Primary Base (IPO / New Issues)
                        </button>
                    </h2>
                    <div id="primaryBase" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>Primary Base</dt>
                                <dd>The first proper consolidation pattern a newly listed stock (IPO) forms after its initial trading period. Minervini requires that a new issue build a primary base before it is considered buyable. This ensures the stock has enough trading history and has been through a constructive correction.</dd>

                                <dt>New Issue</dt>
                                <dd>A stock that has been listed for less than 2 years. These stocks are flagged for primary base analysis since they lack the long trading history that established stocks have.</dd>

                                <dt>Base Duration</dt>
                                <dd>The length of the primary base measured in weeks, starting from the post-IPO high. A minimum of 3 to 5 weeks is needed to form a reliable base. Some IPOs can take up to a year or more.</dd>

                                <dt>Correction Depth</dt>
                                <dd>The maximum percentage decline from the post-IPO high during the base formation. Allowed correction depth depends on the base duration:
                                    <ul class="mt-1 mb-0">
                                        <li><strong>3-week base:</strong> max 25% correction</li>
                                        <li><strong>3-5 week base:</strong> max 25-35% correction</li>
                                        <li><strong>Longer bases (up to ~1 year):</strong> can correct up to 50%</li>
                                    </ul>
                                </dd>

                                <dt>Status: Complete</dt>
                                <dd>The stock has formed a proper primary base that meets the duration and correction requirements, and price has recovered within 15% of its post-IPO high. The stock is eligible for normal BUY/WAIT/PASS evaluation.</dd>

                                <dt>Status: Forming</dt>
                                <dd>The base meets the correction limit for its duration but the price has not yet recovered near the highs. The setup is constructive but needs more time. Signal is capped at WAIT.</dd>

                                <dt>Status: Failed</dt>
                                <dd>The correction from the post-IPO high is too deep for the current base duration. For example, a 3-week base that corrected 30% exceeds the 25% maximum. Signal is set to PASS.</dd>

                                <dt>Status: Too Early</dt>
                                <dd>The stock has been trading for less than 3 weeks since its post-IPO high, which is insufficient time to form a proper base. Wait for more trading history to accumulate.</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <!-- Relative Strength & Momentum -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#rs">
                            Relative Strength & Momentum
                        </button>
                    </h2>
                    <div id="rs" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>Relative Strength (RS)</dt>
                                <dd>A percentile rank (0â€“99) comparing the stockâ€™s price performance vs. the market. RS 80+ means the stock has outperformed 80% of the universe. Leaders typically have RS 70 or higher.</dd>

                                <dt>Industry RS (Ind RS)</dt>
                                <dd>Relative strength of the stockâ€™s industry or sector. Strong stocks often come from strong industry groups.</dd>

                                <dt>3M Return (3M %)</dt>
                                <dd>Price return over the last 3 months. Used to gauge short-term momentum.</dd>

                                <dt>52-Week High / Low</dt>
                                <dd>The highest and lowest price the stock traded at over the past 52 weeks. Leaders often trade near 52-week highs.</dd>

                                <dt>% From 52w High (From High)</dt>
                                <dd>How far the current price is from the 52-week high. Stocks within 10â€“15% of highs are often in strong positions.</dd>

                                <dt>New High (â˜…)</dt>
                                <dd>Indicates the stock is at or very near a 52-week high, showing strong momentum.</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <!-- Volume -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#volume">
                            Volume
                        </button>
                    </h2>
                    <div id="volume" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>$Vol (Avg Dollar Volume)</dt>
                                <dd>Average daily dollar value traded (price Ã— volume). Higher dollar volume (e.g., $20M+) provides better liquidity and institutional participation.</dd>

                                <dt>Volume Ratio (Vol Ratio)</dt>
                                <dd>Todayâ€™s volume divided by the average volume. Values above 1.0 mean above-average volume. Breakouts should ideally occur on 1.5x+ volume.</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <!-- Risk & Reward -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#risk">
                            Risk & Reward
                        </button>
                    </h2>
                    <div id="risk" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>R:R (Risk/Reward Ratio)</dt>
                                <dd>The ratio of potential gain (to target) vs. potential loss (to stop). A 3:1 R:R means you risk $1 to make $3. Higher ratios are preferred.</dd>

                                <dt>Risk %</dt>
                                <dd>The percentage you would lose from entry to stop loss if stopped out. Lower risk per trade (e.g., 3â€“5%) allows better portfolio management.</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <!-- Minervini Criteria -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#minervini">
                            Minervini Methodology
                        </button>
                    </h2>
                    <div id="minervini" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>Passes Minervini (Score)</dt>
                                <dd>Whether the stock meets the 9-point checklist (trend, moving averages, relative strength, earnings, volume, etc.). Shown as X/9 criteria passed plus RS filter.</dd>

                                <dt>Passing Minervini</dt>
                                <dd>Filter for stocks that meet all Minervini criteria. These are pre-screened for high-probability setups.</dd>

                                <dt>Best Setups</dt>
                                <dd>Stocks in Stage 2 with a VCP detected and passing Minervini. Often the highest-quality actionable candidates.</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <!-- Earnings & Fundamentals -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#earnings">
                            Earnings & Fundamentals
                        </button>
                    </h2>
                    <div id="earnings" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>EPS Growth YoY</dt>
                                <dd>Earnings per share growth year over year. Strong growth (e.g., 25%+) is preferred for growth stocks.</dd>

                                <dt>EPS Growth QoQ</dt>
                                <dd>Earnings per share growth quarter over quarter. Indicates acceleration or deceleration in earnings.</dd>

                                <dt>Revenue Growth YoY</dt>
                                <dd>Revenue growth year over year. Confirms that earnings growth is supported by sales growth.</dd>

                                <dt>Earnings Acceleration</dt>
                                <dd>Earnings growth is increasing each quarter. A positive sign that momentum is building.</dd>

                                <dt>Earnings Beat Rate</dt>
                                <dd>Percentage of recent quarters where actual EPS beat estimates. Consistent beaters are often rewarded by the market.</dd>

                                <dt>Earnings Quality Score</dt>
                                <dd>A composite score (0â€“100) of earnings quality based on growth, consistency, and surprises.</dd>

                                <dt>Passes Earnings</dt>
                                <dd>Whether the stock meets the earnings-related criteria (growth, beats, etc.) in the Minervini framework.</dd>

                                <dt>Upcoming Earnings</dt>
                                <dd>Earnings announcement is scheduled within the next 14 days. Consider waiting until after earnings to reduce event risk.</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <!-- Moving Averages -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#ma">
                            Moving Averages
                        </button>
                    </h2>
                    <div id="ma" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>50-Day MA (MA 50)</dt>
                                <dd>50-day simple moving average. Price should ideally be above it in uptrends. Acts as short-term support.</dd>

                                <dt>150-Day MA (MA 150)</dt>
                                <dd>150-day simple moving average. Mid-term trend indicator. Strong stocks stay above this line.</dd>

                                <dt>200-Day MA (MA 200)</dt>
                                <dd>200-day simple moving average. Long-term trend. Price above the 200-day MA is generally bullish.</dd>

                                <dt>200-Day MA Trend (20d)</dt>
                                <dd>The percentage change in the 200-day MA over the last 20 days. A rising 200-day MA confirms an uptrend.</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <!-- Volatility -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#volatility">
                            Volatility
                        </button>
                    </h2>
                    <div id="volatility" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>ATR (Average True Range)</dt>
                                <dd>Measures volatility by averaging the true range over 14 periods. Higher ATR means more price swings.</dd>

                                <dt>ATR %</dt>
                                <dd>ATR as a percentage of price. Helps compare volatility across different price levels.</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <!-- App Features -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#app">
                            App Features
                        </button>
                    </h2>
                    <div id="app" class="accordion-collapse collapse" data-bs-parent="#glossaryAccordion">
                        <div class="accordion-body">
                            <dl>
                                <dt>Watchlist</dt>
                                <dd>Your personalized list of stocks to track. Add symbols for quick access and notifications.</dd>

                                <dt>Notifications</dt>
                                <dd>Alerts when watchlist stocks change (e.g., WAIT â†’ BUY, metric changes, earnings surprises).</dd>

                                <dt>AI Analysis</dt>
                                <dd>AI-generated analysis combining technical metrics with live MarketWatch data (headlines, analyst ratings) for additional context.</dd>

                                <dt>Market Cap Filters</dt>
                                <dd>Filter stocks by size: Mega (&gt;$200B), Large ($10Bâ€“$200B), Mid ($2Bâ€“$10B), Small ($300Mâ€“$2B), Micro (&lt;$300M).</dd>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
